\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tuatreporttitle}

\RequirePackage{graphicx}
\RequirePackage{arydshln}

% デフォルトのタイトル設定
\title{実験報告書}

% 変数定義をするためのマクロ
\newcommand{\regval}[2]{
	\expandafter\newcommand\csname #1value\endcsname{#2}%
	\expandafter\newcommand\csname #1\endcsname[1]{
		\expandafter\renewcommand\csname #1value\endcsname{##1}%
	}%
}

\regval{tuatnumber}{0}   % 学籍番号
\regval{tuatgakki}{前期} % 学期
\regval{tuatgakunen}{1}  % 学年
\regval{tuattani}{2}     % 単位
\regval{tuatkamoku}{}    % 科目
\regval{tuatteacher}{}   % 指導教員
\regval{tuattheme}{}     % テーマ

% 氏名 (デフォルトの\authorのエイリアス)
\newcommand{\tuatauthor}[1]{\author{#1}}

\newcommand{\resetcollaborator}[1]{
	\expandafter\newcommand\csname collaborator#1 \endcsname{}
}
\newcommand\getcollaborator[1]{
	\csname collaborator#1 \endcsname
}
\newcommand{\collaborator}[2]{
	\expandafter\renewcommand\csname collaborator#1 \endcsname{#2}
}

\resetcollaborator1
\resetcollaborator2
\resetcollaborator3
\resetcollaborator4
\resetcollaborator5

\newcommand{\resetdate}[1]{
	\expandafter\newcommand\csname date#1 \endcsname{}
}
\newcommand\getdate[1]{
	\csname date#1 \endcsname
}
\renewcommand{\date}[2]{
	\expandafter\renewcommand\csname date#1 \endcsname{#2}
}

\resetdate1
\resetdate2
\resetdate3
\resetdate4
\resetdate5

\newcommand{\resetduedate}[1]{
	\expandafter\newcommand\csname duedate#1 \endcsname{}
}
\newcommand\getduedate[1]{
	\csname duedate#1 \endcsname
}
\newcommand{\duedate}[2]{
	\expandafter\renewcommand\csname duedate#1 \endcsname{#2}
}

\resetduedate1
\resetduedate2
\resetduedate3
\resetduedate4
\resetduedate5

\newcommand{\resetsubmitdate}[1]{
	\expandafter\newcommand\csname submitdate#1 \endcsname{}
}
\newcommand\getsubmitdate[1]{
	\csname submitdate#1 \endcsname
}
\newcommand{\submitdate}[2]{
	\expandafter\renewcommand\csname submitdate#1 \endcsname{#2}
}

\resetsubmitdate1
\resetsubmitdate2
\resetsubmitdate3
\resetsubmitdate4
\resetsubmitdate5

\setlength{\dashlinegap}{1pt}
\setlength{\arrayrulewidth}{1pt}

% デフォルトの\maketitleの書き換え
% デフォルトの\maketitleは\oldmaketitleとして残してある
\let\oldmaketitle\maketitle
\renewcommand{\maketitle}{
	\pagenumbering{gobble}
	\newgeometry{left=15mm, right=15mm, top=20mm, bottom=10mm}
	\renewcommand{\arraystretch}{1.4}
	\begin{center}
		\LARGE
		\textbf
		\@title
		\begin{table}[ht]
			\centering
			\resizebox*{\textwidth}{0.85\textheight}{
				\begin{tabular}{|c|c|c|c|c|c|}
					\hline
					\multicolumn{3}{|c|}{\textbf{実験演習記録}}         & \multicolumn{3}{c|}{\textbf{判定・指示}}                                                                               \\
					\hline
					                                                    & 年月日時                                 & 共同作業者                         & \multicolumn{3}{c|}{}                  \\
					\cdashline{1-2} \cline{3-3}
					1                                                   & \getdate1                                & \getcollaborator1                  & \multicolumn{3}{c|}{}                  \\
					\cdashline{1-2} \cline{3-3}
					2                                                   & \getdate2                                & \getcollaborator2                  & \multicolumn{3}{c|}{}                  \\
					\cdashline{1-2} \cline{3-3}
					3                                                   & \getdate3                                & \getcollaborator3                  & \multicolumn{3}{c|}{}                  \\
					\cdashline{1-2} \cline{3-3}
					4                                                   & \getdate4                                & \getcollaborator4                  & \multicolumn{3}{c|}{}                  \\
					\cdashline{1-2} \cline{3-3}
					                                                    & \getdate5                                & \getcollaborator5                  & \multicolumn{3}{c|}{}                  \\
					\cline{1-3}
					\multicolumn{3}{|c|}{\textbf{レポート提出記録}}     & \multicolumn{3}{c|}{}                                                                                                  \\
					\cline{1-3}
					                                                    & 提出年月日                               & 期限年月日                         & \multicolumn{3}{c|}{}                  \\
					\cline{1-3}
					初                                                  & \getsubmitdate1                          & \getduedate1                       & \multicolumn{3}{c|}{}                  \\
					\cdashline{1-3}
					再                                                  & \getsubmitdate2                          & \getduedate2                       & \multicolumn{3}{c|}{}                  \\
					\cdashline{1-3}
					                                                    & \getsubmitdate3                          & \getduedate3                       & \multicolumn{3}{c|}{}                  \\
					\cdashline{1-3}
					                                                    & \getsubmitdate4                          & \getduedate4                       & \multicolumn{3}{c|}{}                  \\
					\cdashline{1-3}
					                                                    & \getsubmitdate5                          & \getduedate5                       & \multicolumn{3}{c|}{}                  \\
					\hline
					\multicolumn{2}{|c|}{\textbf{科目名}}               & \textbf{テーマ指導教員}                  & \textbf{学年}                      & \textbf{学期}         & \textbf{単位}  \\
					\hline
					\multicolumn{2}{|c|}{\tuatkamokuvalue}              & \tuatteachervalue                        & \tuatgakunenvalue                  & \tuatgakkivalue       & \tuattanivalue \\
					\hline
					\multicolumn{2}{|c|}{\textbf{テーマ番号・テーマ名}} & \textbf{学籍番号}                        & \multicolumn{3}{c|}{\textbf{名前}}                                          \\
					\hline
					\multicolumn{2}{|c|}{\tuatthemevalue}               & \tuatnumbervalue                         & \multicolumn{3}{c|}{\@author}                                               \\
					\hline
				\end{tabular}
			}
		\end{table}

		\large
		東京農工大学　工学部　知能情報システム工学科
	\end{center}
	\restoregeometry

	\renewcommand{\arraystretch}{1}

	\normalsize
	\newpage
	\pagenumbering{arabic}
}
